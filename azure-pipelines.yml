# Docker image, Azure Container Registry, and Azure Kubernetes Service
# Build a Docker image, push it to an Azure Container Registry, and deploy it to Azure Kubernetes Service.
# https://docs.microsoft.com/azure/devops/pipelines/languages/docker

trigger:
- master

resources:
- repo: self

variables:
  # ========================================================================
  #                          Mandatory variables 
  # ========================================================================

  # Update the name of the dev environment
  Dev.EnvironmentName: 'SmartHotel360-dev'

  # Update the namespace in the dev environment
  Dev.Namespace: 'abc-fe88'

  # Update Kubernetes serviceconnectionId for Dev environment
  Dev.Kubernetes.ServiceConnectionId: '8f8dd969-8322-4e32-9f9d-962dcb985f82'

  # Update the name of the dev environment
  Prod.EnvironmentName: 'SmartHotel360-prod'

  # Update the namespace in the Prod environment
  Prod.Namespace: 'default'

  # Update Kubernetes serviceconnectionId for Prod environment
  Prod.Kubernetes.ServiceConnectionId: 'c8c547b8-fd0c-40db-85b2-6c37d3d14e2b'

  VariableGroupName: 'Test'
  DevEnvironmentResourceName: '$(Dev.EnvironmentName).$(Dev.Namespace)'

stages:
  - stage: A
    jobs:
      - job: test
        displayName: Test        
        pool: Default
        steps:
          - script: echo abc
  - stage: B
    jobs:
      - job: test
        displayName: Test        
        pool: Default
        steps:
          - script: echo abc